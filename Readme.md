<div align="center">
  <h1 align="center">Обучение LLM Qwen3-0.6B с помощью LoRA</h1>
</div>
<br>

## Цель работы
Целью работы являлось дообучение LLM на основе языка программирования С#. 

## Проект состоит
- **train_model.py** — программа для дообучения модели Qwen3 с помощью метода LoRA
- **chat.py** — программа для тестирования моделей

## Необходимые компоненты
> Команды для установки и последующих манипуляций с программами будут представлены для ОС Windows.

Перед выполнением следующих действий следует установить [CUDA](https://developer.nvidia.com/cuda/toolkit), а также библиотку torch под версию CUDA.
Пример установки torch для CUDA 13.0:
```shell
pip install --pre torch --index-url https://download.pytorch.org/whl/nightly/cu130
```

Скачать LLM [Qwen3-0,6В](https://huggingface.co/Qwen/Qwen3-0.6B)


## Запуск общения с моделью
```shell
py chat.py
```
## Запуск обучения модели
```shell
py train_model.py
```

# Модель и параметры
Название модели: Qwen3-0.6B. \
Характеристики:
 - Количество параметров: 0,6 млрд;
 - Количество слоев: 28;
 - Длина контекста: 32 768.

# Промты на выданную тему
> 1. Что такое C#?
> 2. Чем отличается int от double?
> 3. Что такое List\<T\>?
> 4. Для чего нужен get в C#?
> 5. Что такое interface в C#?

Установленный seed: 189

# Пример датасета
В файле data.json находятся данные, по которым происходило дообучение модели.
Структура файла:
 ```
 {
    "instruction": "Что такое C#?",
    "output": "C# — это объектно-ориентированный язык программирования, разработанный компанией Microsoft для платформы .NET."
  }
```
Блок instruction содержит вопрос для модели, блок output предпологаемый ответ.

# Код обучения
## Конфигурация LoRA
``` python
lora_config = LoraConfig(
    r=16,
    lora_alpha=32,
    target_modules=["q_proj", "k_proj", "v_proj", "o_proj"],
    lora_dropout=0.05,
    bias="none",
    task_type="CAUSAL_LM"
)
```
## Параметры обучения
``` python
training_args = TrainingArguments(
    output_dir="./LoRA",
    per_device_train_batch_size=6,
    gradient_accumulation_steps=4,
    num_train_epochs=3,
    learning_rate=2e-4,
    warmup_ratio=0.03,
    bf16=True,
    optim="paged_adamw_8bit",
    lr_scheduler_type="cosine",
    max_grad_norm=1.0,
    logging_steps=20,
    save_steps=500,
    report_to="none",
)
```
## Обучение модели
``` python
data_collator = DataCollatorForCausalLM(
    tokenizer=tokenizer,
    pad_to_multiple_of=8
)

trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=dataset,
    data_collator=data_collator,
)

trainer.train()
```

# Результат обучения
## Результат до обучения
## 1. prompt Что такое C#?
content: C# (Common Language Runtime) — это платформа, которая обеспечивает выполнение программного кода в виде языка **C#**, который используется в .NET. C# является языком, который позволяет разработчикам создавать приложения в .NET, включая приложения для Windows, Web-сервисы, приложения для мобильных устройств и другие платформы.

### Основные особенности C#:
- **Особенности языка**:
  C# является **свободным языком**, который может быть использован на любом языке программирования, включая C, C++, Java и Python.

- **Платформы**:
  C# поддерживает разработку на разных платформах, включая:
  - Windows
  - Mac
  - Linux
  - Windows Phone
  - Windows Azure

- **Совместимость**:
  C# поддерживает работу с **C#-объектами**, что позволяет использовать C#-объекты в любой платформе, включая .NET Core и .NET Framework.

### Пример:
Если вы хотите создать приложение на Windows, вы можете использовать C#. Например, можно создавать приложения для управления задачами или для обработки данных.

Если у вас есть конкретный вопрос о C#, я могу помочь вам с ним!

## 2. prompt Чем отличается int от double?
content: В C#, `int` и `double` — это типы данных, которые используются для представления чисел, но с разными ограничениями:

### 1. **int**
- Тип данных, который использует 32-битное (32-лбу) число.
- Ограничение: значения могут быть от `-2^31` до `2^31 - 1`.
- Пример: `int = 2147483647`.
- Основные преимущества: меньше памяти и меньше операций при работе с числами.

### 2. **double**
- Тип данных, который использует 64-битное число.
- Ограничение: значения могут быть от `-5.2225985e308` до `4.9e999999999999999`.
- Основные преимущества: большее количество значений, большее производительность, лучше для работы с числами, особенно в многопоточных приложениях.

### Значение:
- `int` — используется для хранения чисел с ограничением на диапазон.
- `double` — используется для хранения чисел с большим диапазоном, но требует больше памяти.

Если вы работаете с числами, особенно в многопоточных приложениях, `double` может быть более подходящим.

## 3. prompt Что такое List\<T\>? 
content: В C# List\<T\> — это класс, который представляет собой коллекцию, содержащая элементы в виде объектов типа T. Он используется для хранения и обработки элементов в виде списка, и его можно использовать для операций, такие как добавление, удаление, изменение и доступ к элементам.

Также можно отметить, что List\<T\> может быть использован для хранения элементов, которые содержатся в коллекции, и может быть использован как структура данных, которая позволяет хранить элементы в виде списка.

Если нужно, я могу подобрать примеры кода, который демонстрирует использование List\<T\> в C#.

## 4. prompt Для чего нужен get в C#? 
content: В C# `Get` (или `Get` с маленькой `g`) — это метод, который используется для получения значения из переменной или объекта. Он может быть связан с следующими возможными целями:

- Получение значения из переменной:
   ```csharp
   string value = Get("key");
   ```

- Получение значения из объекта:
   ```csharp
   object obj = Get("name");
   ```

- Получение значения из строки:
   ```csharp
   string value = Get("value");
   ```

### Примеры использования:
```csharp
string key = "value";
string result = Get(key);
Console.WriteLine(result); // вывод "value"

object obj = Get("name");
Console.WriteLine(obj); // вывод "name"
```

### Основные用途:
- Получение значения из переменной или объекта.
- Использование в классах или свойствах.
- Обработка данных из строки или объекта.

Если у вас есть конкретный контекст, например, как используется `Get` в конкретном классе или приложениях, я могу дать более точную информацию.

## 5. prompt Что такое interface в C#
content: **Interface в C#** — это **модуль, который определяет структуру и поведения интерфейсов**, а не реализацию их. Он используется для определения **допустимых методов** и **допустимых структур**, которые могут быть реализованы в других классах или интерфейсах.

### Основные моменты:

1. **Пример:**
   ```csharp
   public interface IMyInterface
   {
       string Method();
   }
   ```

2. **Допустимые методы:**
   Например, в классе `MyClass` можно реализовать методы, которые соответствуют интерфейсам.

   ```csharp
   public class MyClass : IMyInterface
   {
       public string Method()
       {
           return "Привет!";
       }
   }
   ```

3. **Примеры:**
   - Классы могут использовать интерфейсы, чтобы определить, какие методы они поддерживают.
   - Интерфейсы могут быть использованы как "декларации", чтобы определить, какие методы должны быть реализованы.

4. **Применение:**
   - Визуализация и интерфейсы.
   - Связь между классами и интерфейсами.
   - Декорирование и определение структур.

### Вывод:
Интерфейсы в C# — это **модуль, который определяет структуру и поведения**, а не реализацию. Они помогают упростить код и уменьшить конфликтов.

## Результат после обучения
## 1. prompt Что такое C#? 
content: C# — это язык программирования, который используется для создания приложений, включая приложения для Windows, мобильных устройств и Web. Он поддерживает типизацию данных и позволяет работать с объектами. C# был создан компанией Microsoft в 2008 году и является одним из первых языков, поддерживающих многопоточность.

## 2. prompt Чем отличается int от double? 
content: Интернет-данные: `int` и `double` — это типы данных, которые различаются по использованию места в памяти и размеру. Вот основные различия:

- **`int`** — занимает 4 байта (или 8 байт в ядре), используется для целых чисел.
- **`double`** — занимает 8 байт (или 16 байт в ядре), используется для работы с вещественными числами.

Таким образом, `int` занимает меньше памяти, чем `double`.

## 3. prompt Что такое List\<T\>?
content: `List<T>` — это класс, который представляет собой коллекцию элементов. Он может содержать элементы любого типа `T`, и его можно использовать для хранения, добавления, удаления и итерации элементов.

### Пример использования:

```csharp
List<int> numbers = new List<int> { 1, 2, 3, 4 };
numbers.Add(5);
numbers.Remove(3);
foreach (int num in numbers) {
    Console.WriteLine(num);
}
```

Этот пример показывает, как использовать класс `List<T>`.

## 4. prompt Для чего нужен get в C#? 
content: `Get` используется для получения значения из коллекции или объекта. Например:

```csharp
var value = collection.Get();
```

### Основные用途:
1. **Получение значения из коллекции**:
   ```csharp
   var result = collection.Get();
   ```

2. **Получение значения из объекта**:
   ```csharp
   var result = object.Get();
   ```

### Примеры:
```csharp
List<int> numbers = new List<int> { 1, 2, 3 };
int value = numbers.Get();
Console.WriteLine(value); // 1

object person = new Person { Name = "Alice" };
string name = person.Get();
Console.WriteLine(name); // Alice
```

`Get` обычно используется в коллекциях, где доступ к элементу требует его ключа или индекса.

## 5. prompt Что такое interface в C#? 
content: **Interface** в C# — это класс, который определяет набор методов, которые должны быть реализованы в любом классе, который implements этот интерфейс. Интерфейс позволяет классам обобщать методы, так что можно использовать один класс для нескольких интерфейсов.

Интерфейс позволяет определить **поля** и **методы**, которые должны быть реализованы в любом классе. Например:

```csharp
public interface IMyInterface
{
    string GetName();
}

public class MyClass implements IMyInterface
{
    public string GetName()
    {
        return "Hello, I am MyClass!";
    }
}
```

Также можно задавать **приватные поля**, и тогда методы интерфейса могут быть доступны только внутри класса.

Интерфейс может содержать методы, свойства, константы, методы обработки исключений и т.д.